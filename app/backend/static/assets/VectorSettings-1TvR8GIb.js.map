{"version":3,"file":"VectorSettings-1TvR8GIb.js","sources":["../../../frontend/src/components/HelpCallout/HelpCallout.tsx","../../../frontend/src/components/VectorSettings/VectorSettings.tsx"],"sourcesContent":["import { ITextFieldProps, DefaultButton, IconButton, IButtonStyles, Callout, IStackTokens, Stack, IStackStyles, initializeIcons } from \"@fluentui/react\";\nimport { useBoolean, useId } from \"@fluentui/react-hooks\";\nimport { useTranslation } from \"react-i18next\";\n\nconst stackTokens: IStackTokens = {\n    childrenGap: 4,\n    maxWidth: 300\n};\n\nconst labelCalloutStackStyles: Partial<IStackStyles> = { root: { padding: 20 } };\nconst iconButtonStyles: Partial<IButtonStyles> = { root: { marginBottom: -3 } };\nconst iconProps = { iconName: \"Info\" };\n\ninterface IHelpCalloutProps {\n    label: string | undefined;\n    labelId: string;\n    fieldId: string | undefined;\n    helpText: string;\n}\n\nexport const HelpCallout = (props: IHelpCalloutProps): JSX.Element => {\n    const [isCalloutVisible, { toggle: toggleIsCalloutVisible }] = useBoolean(false);\n    const descriptionId: string = useId(\"description\");\n    const iconButtonId: string = useId(\"iconButton\");\n    const { t } = useTranslation();\n\n    return (\n        <>\n            <Stack horizontal verticalAlign=\"center\" tokens={stackTokens}>\n                <label id={props.labelId} htmlFor={props.fieldId}>\n                    {props.label}\n                </label>\n                <IconButton\n                    id={iconButtonId}\n                    iconProps={iconProps}\n                    title={t(\"tooltips.info\")}\n                    ariaLabel={t(\"tooltips.info\")}\n                    onClick={toggleIsCalloutVisible}\n                    styles={iconButtonStyles}\n                />\n            </Stack>\n            {isCalloutVisible && (\n                <Callout target={\"#\" + iconButtonId} setInitialFocus onDismiss={toggleIsCalloutVisible} ariaDescribedBy={descriptionId} role=\"alertdialog\">\n                    <Stack tokens={stackTokens} horizontalAlign=\"start\" styles={labelCalloutStackStyles}>\n                        <span id={descriptionId}>{props.helpText}</span>\n                        <DefaultButton onClick={toggleIsCalloutVisible}>{t(\"labels.closeButton\")}</DefaultButton>\n                    </Stack>\n                </Callout>\n            )}\n        </>\n    );\n};\n","import { useEffect, useState } from \"react\";\nimport { Stack, IDropdownOption, Dropdown, Checkbox, IDropdownProps } from \"@fluentui/react\";\nimport { useId } from \"@fluentui/react-hooks\";\nimport { useTranslation } from \"react-i18next\";\n\nimport styles from \"./VectorSettings.module.css\";\nimport { HelpCallout } from \"../../components/HelpCallout\";\nimport { RetrievalMode } from \"../../api\";\n\ninterface Props {\n    showImageOptions?: boolean;\n    defaultRetrievalMode: RetrievalMode;\n    defaultSearchTextEmbeddings?: boolean;\n    defaultSearchImageEmbeddings?: boolean;\n    updateRetrievalMode: (retrievalMode: RetrievalMode) => void;\n    updateSearchTextEmbeddings: (searchTextEmbeddings: boolean) => void;\n    updateSearchImageEmbeddings: (searchImageEmbeddings: boolean) => void;\n}\n\nexport const VectorSettings = ({\n    updateRetrievalMode,\n    updateSearchTextEmbeddings,\n    updateSearchImageEmbeddings,\n    showImageOptions,\n    defaultRetrievalMode,\n    defaultSearchTextEmbeddings = true,\n    defaultSearchImageEmbeddings = true\n}: Props) => {\n    const [retrievalMode, setRetrievalMode] = useState<RetrievalMode>(defaultRetrievalMode || RetrievalMode.Hybrid);\n    const [searchTextEmbeddings, setSearchTextEmbeddings] = useState<boolean>(defaultSearchTextEmbeddings);\n    const [searchImageEmbeddings, setSearchImageEmbeddings] = useState<boolean>(defaultSearchImageEmbeddings);\n\n    const onRetrievalModeChange = (_ev: React.FormEvent<HTMLDivElement>, option?: IDropdownOption<RetrievalMode> | undefined) => {\n        setRetrievalMode(option?.data || RetrievalMode.Hybrid);\n        updateRetrievalMode(option?.data || RetrievalMode.Hybrid);\n    };\n\n    const onSearchTextEmbeddingsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setSearchTextEmbeddings(checked || false);\n        updateSearchTextEmbeddings(checked || false);\n    };\n\n    const onSearchImageEmbeddingsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setSearchImageEmbeddings(checked || false);\n        updateSearchImageEmbeddings(checked || false);\n    };\n\n    // Only run if showImageOptions changes from true to false or false to true\n    useEffect(() => {\n        if (!showImageOptions) {\n            // If images are disabled, we must disable image embeddings\n            setSearchImageEmbeddings(false);\n            updateSearchImageEmbeddings(false);\n        } else {\n            // When image options become available, reset to default\n            setSearchImageEmbeddings(defaultSearchImageEmbeddings);\n            updateSearchImageEmbeddings(defaultSearchImageEmbeddings);\n        }\n    }, [showImageOptions, updateSearchImageEmbeddings, defaultSearchImageEmbeddings]);\n\n    const retrievalModeId = useId(\"retrievalMode\");\n    const retrievalModeFieldId = useId(\"retrievalModeField\");\n    const vectorFieldsId = useId(\"vectorFields\");\n    const vectorFieldsFieldId = useId(\"vectorFieldsField\");\n    const { t } = useTranslation();\n\n    return (\n        <Stack className={styles.container} tokens={{ childrenGap: 10 }}>\n            <Dropdown\n                id={retrievalModeFieldId}\n                label={t(\"labels.retrievalMode.label\")}\n                selectedKey={retrievalMode.toString()}\n                options={[\n                    {\n                        key: \"hybrid\",\n                        text: t(\"labels.retrievalMode.options.hybrid\"),\n                        selected: retrievalMode == RetrievalMode.Hybrid,\n                        data: RetrievalMode.Hybrid\n                    },\n                    {\n                        key: \"vectors\",\n                        text: t(\"labels.retrievalMode.options.vectors\"),\n                        selected: retrievalMode == RetrievalMode.Vectors,\n                        data: RetrievalMode.Vectors\n                    },\n                    { key: \"text\", text: t(\"labels.retrievalMode.options.texts\"), selected: retrievalMode == RetrievalMode.Text, data: RetrievalMode.Text }\n                ]}\n                required\n                onChange={onRetrievalModeChange}\n                aria-labelledby={retrievalModeId}\n                onRenderLabel={(props: IDropdownProps | undefined) => (\n                    <HelpCallout labelId={retrievalModeId} fieldId={retrievalModeFieldId} helpText={t(\"helpTexts.retrievalMode\")} label={props?.label} />\n                )}\n            />\n\n            {showImageOptions && [RetrievalMode.Vectors, RetrievalMode.Hybrid].includes(retrievalMode) && (\n                <fieldset className={styles.fieldset}>\n                    <legend className={styles.legend}>{t(\"labels.vector.label\")}</legend>\n                    <Stack tokens={{ childrenGap: 8 }}>\n                        <Checkbox\n                            id={vectorFieldsFieldId + \"-text\"}\n                            label={t(\"labels.vector.options.embedding\")}\n                            checked={searchTextEmbeddings}\n                            onChange={onSearchTextEmbeddingsChange}\n                            aria-labelledby={vectorFieldsId + \"-text\"}\n                            onRenderLabel={props => (\n                                <HelpCallout\n                                    labelId={vectorFieldsId + \"-text\"}\n                                    fieldId={vectorFieldsFieldId + \"-text\"}\n                                    helpText={t(\"helpTexts.textEmbeddings\")}\n                                    label={props?.label}\n                                />\n                            )}\n                        />\n                        <Checkbox\n                            id={vectorFieldsFieldId + \"-image\"}\n                            label={t(\"labels.vector.options.imageEmbedding\")}\n                            checked={searchImageEmbeddings}\n                            onChange={onSearchImageEmbeddingsChange}\n                            aria-labelledby={vectorFieldsId + \"-image\"}\n                            onRenderLabel={props => (\n                                <HelpCallout\n                                    labelId={vectorFieldsId + \"-image\"}\n                                    fieldId={vectorFieldsFieldId + \"-image\"}\n                                    helpText={t(\"helpTexts.imageEmbeddings\")}\n                                    label={props?.label}\n                                />\n                            )}\n                        />\n                    </Stack>\n                </fieldset>\n            )}\n        </Stack>\n    );\n};\n"],"names":["stackTokens","labelCalloutStackStyles","iconButtonStyles","iconProps","HelpCallout","props","isCalloutVisible","toggleIsCalloutVisible","useBoolean","descriptionId","useId","iconButtonId","t","useTranslation","jsxs","Fragment","Stack","jsx","IconButton","Callout","DefaultButton","VectorSettings","updateRetrievalMode","updateSearchTextEmbeddings","updateSearchImageEmbeddings","showImageOptions","defaultRetrievalMode","defaultSearchTextEmbeddings","defaultSearchImageEmbeddings","retrievalMode","setRetrievalMode","useState","RetrievalMode","searchTextEmbeddings","setSearchTextEmbeddings","searchImageEmbeddings","setSearchImageEmbeddings","onRetrievalModeChange","_ev","option","onSearchTextEmbeddingsChange","checked","onSearchImageEmbeddingsChange","useEffect","retrievalModeId","retrievalModeFieldId","vectorFieldsId","vectorFieldsFieldId","styles","Dropdown","Checkbox"],"mappings":"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"}