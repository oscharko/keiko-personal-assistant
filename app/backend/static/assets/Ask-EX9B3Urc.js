import{r as t,bX as it,bM as ct,bG as a,bZ as ut}from"./vendor-C7z-rhZx.js";import{R as pe,u as P,L as lt,U as St,S as mt,Q as dt,a as pt,E as ht,A as gt,b as S,c as wt,d as kt,e as bt,r as ft,T as xt,f as _t,g as Ct,h as Rt}from"./index-DO-zPLG9.js";import{b as Tt,g as At,D as Et}from"./fluentui-react-Dbzz8a2r.js";import"./fluentui-icons-BNzCICnG.js";const Ot="_askContainer_1rw8c_1",yt="_askTopSection_1rw8c_8",Pt="_askBottomSection_1rw8c_15",jt="_askTitle_1rw8c_25",vt="_askQuestionInput_1rw8c_31",It="_askAnswerContainer_1rw8c_37",Bt="_askAnalysisPanel_1rw8c_44",Qt="_commandsContainer_1rw8c_61",Mt="_commandButton_1rw8c_68",n={askContainer:Ot,askTopSection:yt,askBottomSection:Pt,askTitle:jt,askQuestionInput:vt,askAnswerContainer:It,askAnalysisPanel:Bt,commandsContainer:Qt,commandButton:Mt};function Lt(){const[j,m]=t.useState(!1),[d,he]=t.useState(""),[p,ge]=t.useState(""),[h,we]=t.useState(""),[v,ke]=t.useState(.3),[g,be]=t.useState(null),[I,fe]=t.useState(1.9),[B,xe]=t.useState(0),[Q,M]=t.useState(pe.Hybrid),[L,U]=t.useState(3),[N,W]=t.useState("minimal"),[q,D]=t.useState(!0),[H,_e]=t.useState(!1),[V,z]=t.useState(!1),[F,K]=t.useState(""),[G,X]=t.useState(!0),[Z,J]=t.useState(!1),[w,Ce]=t.useState(""),[k,Re]=t.useState(""),[Te,Ae]=t.useState(""),[Y,$]=t.useState(!0),[ee,te]=t.useState(!1),[se,Ee]=t.useState(!1),[Oe,ye]=t.useState(!1),[Pe,je]=t.useState(!1),[ve,Ie]=t.useState(!1),[Be,Qe]=t.useState(!1),[Me,Le]=t.useState(!1),[Ue,Ne]=t.useState(!1),[We,qe]=t.useState(!1),[De,He]=t.useState(!1),[Ve,ze]=t.useState(!1),Fe=t.useRef(new Audio).current,[Ke,Ge]=t.useState(!1),[Xe,Ze]=t.useState(!1),[b,Je]=t.useState(!1),[f,c]=t.useState(!1),[x,Ye]=t.useState(!1),[ae,_]=t.useState(!1),[C,ne]=t.useState(!1),[$e,R]=t.useState(!1),T=t.useRef(""),[A,oe]=t.useState(!1),[u,re]=t.useState(),[r,et]=t.useState(),[tt,ie]=t.useState([]),st={speechUrls:tt,setSpeechUrls:ie,audio:Fe,isPlaying:Ke,setIsPlaying:Ge},[ce,ue]=t.useState(),[l,i]=t.useState(void 0),le=P?it().instance:void 0,{loggedIn:Se}=t.useContext(lt),at=async()=>{_t().then(e=>{Ee(e.showMultimodalOptions),e.showMultimodalOptions&&(X(e.ragSendTextSources!==void 0?e.ragSendTextSources:!0),J(e.ragSendImageSources),$(e.ragSearchTextEmbeddings),te(e.ragSearchImageEmbeddings)),D(e.showSemanticRankerOption),ye(e.showSemanticRankerOption),z(e.showQueryRewritingOption),je(e.showQueryRewritingOption),Ie(e.showReasoningEffortOption),e.showReasoningEffortOption&&K(e.defaultReasoningEffort),Qe(e.showVectorOption),e.showVectorOption||M(pe.Text),Le(e.showUserUpload),Ne(e.showLanguagePicker),qe(e.showSpeechInput),He(e.showSpeechOutputBrowser),ze(e.showSpeechOutputAzure),Ze(e.showAgenticRetrievalOption),ne(e.showAgenticRetrievalOption),Je(e.webSourceEnabled),c(e.webSourceEnabled),Ye(e.sharepointSourceEnabled),_(e.sharepointSourceEnabled),e.showAgenticRetrievalOption&&U(10);const s=e.defaultRetrievalReasoningEffort??"minimal";R(e.webSourceEnabled),W(s)})};t.useEffect(()=>{at()},[]);const E=async e=>{T.current=e,u&&re(void 0),oe(!0),ue(void 0),i(void 0);const s=le?await Ct(le):void 0;try{const y={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:d.length===0?void 0:d,prompt_template_prefix:p.length===0?void 0:p,prompt_template_suffix:h.length===0?void 0:h,include_category:w.length===0?void 0:w,exclude_category:k.length===0?void 0:k,top:L,...C?{retrieval_reasoning_effort:N}:{},temperature:v,minimum_reranker_score:I,minimum_search_score:B,retrieval_mode:Q,semantic_ranker:q,semantic_captions:H,query_rewriting:V,reasoning_effort:F,search_text_embeddings:Y,search_image_embeddings:ee,send_text_sources:G,send_image_sources:Z,language:de.language,use_agentic_knowledgebase:C,use_web_source:b?f:!1,use_sharepoint_source:x?ae:!1,...g!==null?{seed:g}:{}}},session_state:r?r.session_state:null},rt=await Rt(y,s);et(rt),ie([null])}catch(y){re(y)}finally{oe(!1)}},nt=(e,s)=>{switch(e){case"promptTemplate":he(s);break;case"promptTemplatePrefix":ge(s);break;case"promptTemplateSuffix":we(s);break;case"temperature":ke(s);break;case"seed":be(s);break;case"minimumRerankerScore":fe(s);break;case"minimumSearchScore":xe(s);break;case"retrieveCount":U(s);break;case"agenticReasoningEffort":W(s),s==="minimal"&&f&&(c(!1),R(!1));break;case"useSemanticRanker":D(s);break;case"useSemanticCaptions":_e(s);break;case"useQueryRewriting":z(s);break;case"reasoningEffort":K(s);break;case"excludeCategory":Re(s);break;case"includeCategory":Ce(s);break;case"llmInputs":break;case"sendTextSources":X(s);break;case"sendImageSources":J(s);break;case"searchTextEmbeddings":$(s);break;case"searchImageEmbeddings":te(s);break;case"retrievalMode":M(s);break;case"useAgenticKnowledgeBase":ne(s);break;case"useWebSource":if(!b){c(!1);return}c(s),R(s);break;case"useSharePointSource":if(!x){_(!1);return}_(s);break}},ot=e=>{E(e),Ae(e)},me=e=>{ce===e&&l===S.CitationTab?i(void 0):(ue(e),i(S.CitationTab))},O=e=>{i(l===e?void 0:e)},{t:o,i18n:de}=ct();return a.jsxs("div",{className:n.askContainer,children:[a.jsx(ut,{children:a.jsx("title",{children:o("pageTitle")})}),a.jsxs("div",{className:n.askTopSection,children:[a.jsxs("div",{className:n.commandsContainer,children:[Me&&a.jsx(St,{className:n.commandButton,disabled:!Se}),a.jsx(mt,{className:n.commandButton,onClick:()=>m(!j)})]}),a.jsx("h1",{className:n.askTitle,children:o("askTitle")}),a.jsx("div",{className:n.askQuestionInput,children:a.jsx(dt,{placeholder:o("multimodalExamples.placeholder"),disabled:A,initQuestion:Te,onSend:e=>E(e),showSpeechInput:We})})]}),a.jsxs("div",{className:n.askBottomSection,children:[A&&a.jsx(Tt,{label:o("generatingAnswer")}),!T.current&&a.jsxs("div",{className:n.askTopSection,children:[Ue&&a.jsx(pt,{onLanguageChange:e=>de.changeLanguage(e)}),a.jsx(ht,{onExampleClicked:ot,useMultimodalAnswering:se})]}),!A&&r&&!u&&a.jsx("div",{className:n.askAnswerContainer,children:a.jsx(gt,{answer:r,index:0,speechConfig:st,isStreaming:!1,onCitationClicked:e=>me(e),onThoughtProcessClicked:()=>O(S.ThoughtProcessTab),onSupportingContentClicked:()=>O(S.SupportingContentTab),showSpeechOutputAzure:Ve,showSpeechOutputBrowser:De})}),u?a.jsx("div",{className:n.askAnswerContainer,children:a.jsx(wt,{error:u.toString(),onRetry:()=>E(T.current)})}):null,l&&r&&a.jsx(kt,{className:n.askAnalysisPanel,activeCitation:ce,onActiveTabChanged:e=>O(e),citationHeight:"600px",answer:r,activeTab:l,onCitationClicked:me})]}),a.jsxs(At,{headerText:o("labels.headerText"),isOpen:j,isBlocking:!1,onDismiss:()=>m(!1),closeButtonAriaLabel:o("labels.closeButton"),onRenderFooterContent:()=>a.jsx(Et,{onClick:()=>m(!1),children:o("labels.closeButton")}),isFooterAtBottom:!0,children:[a.jsx(bt,{promptTemplate:d,promptTemplatePrefix:p,promptTemplateSuffix:h,temperature:v,retrieveCount:L,agenticReasoningEffort:N,seed:g,minimumSearchScore:B,minimumRerankerScore:I,useSemanticRanker:q,useSemanticCaptions:H,useQueryRewriting:V,reasoningEffort:F,excludeCategory:k,includeCategory:w,retrievalMode:Q,sendTextSources:G,sendImageSources:Z,searchTextEmbeddings:Y,searchImageEmbeddings:ee,showSemanticRankerOption:Oe,showQueryRewritingOption:Pe,showReasoningEffortOption:ve,showMultimodalOptions:se,showVectorOption:Be,useLogin:!!P,loggedIn:Se,requireAccessControl:ft,showAgenticRetrievalOption:Xe,useAgenticKnowledgeBase:C,useWebSource:f,showWebSourceOption:b,useSharePointSource:ae,showSharePointSourceOption:x,hideMinimalRetrievalReasoningOption:$e,onChange:nt}),P&&a.jsx(xt,{})]})]})}Lt.displayName="Ask";export{Lt as Component};
//# sourceMappingURL=Ask-EX9B3Urc.js.map
